
model {
    phi ~ dunif(0, 1)
    p ~ dunif(0, 1)
    for(i in 1:nind) {
        for(j in (first[i]+1):last[i]) {
            y[i,j] ~ dbin(p, 1)
            onesMatrix[i,j] ~ dbin(phi, 1)
        }
        onesVector[i] ~ dbin(chi[last[i]], 1)
    }
    chi[k] <- 1
    for(j in 1:(k-1)) {
        chi[k-j] <- (1-phi) + phi * (1-p) * chi[k-j+1]
    }
}

